<form class="form-horizontal user_sttng_panel pt_shadow row vp_forms" id="avatar-settings" method="POST">
	<div class="col-md-1"></div>
	<div class="col-md-10">
		<h2 class="user_sttng_panel_hd">{{LANG avatar_and_cover}} {{LANG settings}}</h2>
		<div class="setting-avatar-alert"></div>
		<div class="progress hidden">
            <div class="progress_bar_parent">
                <div class="bar upload-progress-bar progress-bar active"></div> 
            </div>
			<span class="percent">0%</span>
            <div class="clear"></div>
        </div>
		<div class="text-center pt_prcs_vdo"></div>
		
        <div class="vp_cset_cover" title="{{LANG cover}}">
            <div class="vp_cset_cover_hdr">
                <span class="btn btn-file" id="coverimage-holder" onclick="$('#cover').trigger('click'); return false;">
                    <span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32"><path fill="currentColor" d="M26.334 4h-20.668c-2.021 0-3.666 1.645-3.666 3.666v16.668c0 2.021 1.645 3.666 3.666 3.666h20.668c2.021 0 3.666-1.645 3.666-3.666v-16.668c0-2.021-1.645-3.666-3.666-3.666zM9 9c1.105 0 2 0.895 2 2s-0.895 2-2 2c-1.104 0-2-0.895-2-2s0.896-2 2-2zM26 23c0 0.553-0.447 0.984-1 0.984l-17.94 0.016c-0.004 0-0.007 0-0.011 0-0.315 0-0.613-0.134-0.802-0.387-0.191-0.256-0.248-0.58-0.153-0.886 0.072-0.234 1.821-5.736 5.627-5.736 1.19 0.028 2.107 0.307 2.993 0.573 1.116 0.335 2.204 0.623 3.427 0.43 0.639-0.103 0.903-0.744 1.354-2.186 0.595-1.9 1.494-4.773 5.458-4.773 0.548 0 0.993 0.44 1 0.988l0.047 3.965v7.012z" /></svg></span>
                </span>
                <input type="file" class="hidden" id="cover" accept="image/x-png, image/gif, image/jpeg" name="cover">
            </div>
			<div class="avatar-read" id="cover-form"><p></p></div>
		</div>
		<div class="vp_cset_avtr">
            <div class="vp_cset_avtr_hdr">
                <span class="btn btn-file" id="avatarimage-holder" onclick="$('#avatar').trigger('click'); return false;" title="{{LANG avatar}}">
                    <span><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32"><path fill="currentColor" d="M26 6h-10c0-1.654-1.346-3-3-3h-2c-1.654 0-3 1.346-3 3h-3c-1.654 0-3 1.346-3 3v16c0 1.654 1.346 3 3 3h13.059c0.284 0 0.556-0.121 0.745-0.333s0.28-0.495 0.249-0.777c-0.029-0.263-0.049-0.527-0.049-0.798 0-4.427 4.131-7.959 8.747-6.771 0.299 0.075 0.617 0.011 0.862-0.179s0.387-0.481 0.387-0.789v-9.353c0-1.654-1.346-3-3-3zM15 23c-3.309 0-6-2.691-6-6s2.691-6 6-6 6 2.691 6 6-2.691 6-6 6zM24.5 13c-0.828 0-1.5-0.672-1.5-1.5s0.672-1.5 1.5-1.5 1.5 0.672 1.5 1.5-0.672 1.5-1.5 1.5z"></path>
<path fill="currentColor" d="M26 21.062c-2.762 0-5 2.238-5 5s2.238 5 5 5 5-2.238 5-5-2.238-5-5-5zM28 27h-1v1c0 0.553-0.447 1-1 1s-1-0.447-1-1v-1h-1c-0.553 0-1-0.447-1-1s0.447-1 1-1h1v-1c0-0.553 0.447-1 1-1s1 0.447 1 1v1h1c0.553 0 1 0.447 1 1s-0.447 1-1 1z"></path></svg></span>
                </span>
                <input type="file" class="hidden" id="avatar" accept="image/x-png, image/gif, image/jpeg" name="avatar">
            </div>
			<div class="avatar-read" id="photo-form"><p></p></div>
		</div>

		<input type="hidden" name="hash_id" value="<?php echo PT_CreateSession()?>">
		<input type="hidden" name="user_id" value="{{USER id}}">
		<!-- Button (Double) -->
		<div class="vp_forms_sbm_btn text-center">
			<button type="submit" class="btn btn_primary" id="submit" name="submit"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M0.41,13.41L6,19L7.41,17.58L1.83,12M22.24,5.58L11.66,16.17L7.5,12L6.07,13.41L11.66,19L23.66,7M18,7L16.59,5.58L10.24,11.93L11.66,13.34L18,7Z" /></svg> {{LANG save}}</button>
		</div>
	</div>
	<div class="col-md-1"></div>
</form>

<script>
$(document).ready(function() {
	$("#cover").on('change', function() {
	//Get count of selected files
	$("#coverimage-holder").html("<img src='" + window.URL.createObjectURL(this.files[0]) + "' alt='Picture'>");
	});
});

$(document).ready(function() {
	$("#avatar").on('change', function() {
	//Get count of selected files
	$("#avatarimage-holder").html("<img src='" + window.URL.createObjectURL(this.files[0]) + "' alt='Picture'>");
	});
});

    $(function() {
		var bar         = $('.bar');
        var percent     = $('.percent');
        var prcsvdo      = $('.pt_prcs_vdo');
        //$("#avatar").change(function() {
           // var filename = $(this).val().replace(/C:\\fakepath\\/i, '');
           // $("#photo-form p").html(filename);
           // $("#photo-form").fadeIn(200);
        //});
        $("#cover").change(function() {
            var filename = $(this).val().replace(/C:\\fakepath\\/i, '');
            $("#cover-form p").html(filename);
            $("#cover-form").fadeIn(200);
        });
        var form = $('form#avatar-settings');
        form.ajaxForm({
            url: '{{LINK aj/user/avatar}}?hash=' + $('.main_session').val(),
            beforeSend: function() {
                form.find('button').text("{{LANG please_wait}}");
				$('.progress').removeClass('hidden');
                var percentVal = '0%';
                bar.width(percentVal);
                percent.html(percentVal);
                // FL_progressIconLoader(form.find('button'));
            },
			uploadProgress: function(event, position, total, percentComplete) {
                 if(percentComplete > 50) {
                    percent.addClass('white');
                 }
                var percentVal = percentComplete + '%';
                bar.width(percentVal);
                percent.html(percentVal);

                if (percentComplete == 100) {
                   prcsvdo.html('<svg width="30" height="10" viewBox="0 0 120 30" xmlns="http://www.w3.org/2000/svg" fill="#000"><circle cx="15" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="60" cy="15" r="9" fill-opacity="0.3"><animate attributeName="r" from="9" to="9" begin="0s" dur="0.8s" values="9;15;9" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="0.5" to="0.5" begin="0s" dur="0.8s" values=".5;1;.5" calcMode="linear" repeatCount="indefinite" /></circle><circle cx="105" cy="15" r="15"><animate attributeName="r" from="15" to="15" begin="0s" dur="0.8s" values="15;9;15" calcMode="linear" repeatCount="indefinite" /><animate attributeName="fill-opacity" from="1" to="1" begin="0s" dur="0.8s" values="1;.5;1" calcMode="linear" repeatCount="indefinite" /></circle></svg> {{LANG porcessing_image}}');
                   $('.progress').find('.bar').removeClass('upload-progress-bar');
                }
            },
            success: function(data) {
				percentVal = '0%';
                bar.width(percentVal);
                $('.progress').addClass('hidden');
				prcsvdo.addClass('hidden');
                scrollToTop();
                if (data.status == 200) {
                    $('.setting-avatar-alert').html('<div class="alert alert-success">' + data.message + '</div>');
                    $('.alert-success').fadeIn('fast', function() {
                        $(this).delay(2500).slideUp(500, function() {
                            $(this).remove();
                        });
                    });
                } else if (data.errors) {
                    var errors = data.errors.join("<br>");
                    $('.setting-avatar-alert').html('<div class="alert alert-danger">' + errors + '</div>');
                    $('.alert-danger').fadeIn(300);
                }
                form.find('button').html('<svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24"><path fill="currentColor" d="M0.41,13.41L6,19L7.41,17.58L1.83,12M22.24,5.58L11.66,16.17L7.5,12L6.07,13.41L11.66,19L23.66,7M18,7L16.59,5.58L10.24,11.93L11.66,13.34L18,7Z" /></svg> {{LANG save}}');
                // FL_progressIconLoader(form.find('button'));
            }
        });
    });
</script>